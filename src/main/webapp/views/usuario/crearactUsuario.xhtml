<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

<body>
    <ui:composition template="./../newTemplate.xhtml">
        
        <ui:define name="title">
            <h:outputText value="#{userController.user.idUsuario == null ? 'Registrar Usuario' : 'Editar Usuario'}" />
        </ui:define>
        
        <ui:define name="head">
            <style>
                .form-card {
                    background: rgba(255, 255, 255, 0.98);
                    border-radius: 12px;
                    padding: 2rem;
                    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
                    border: 1px solid rgba(255, 255, 255, 0.6);
                    margin-bottom: 2rem;
                }
                
                .form-title {
                    color: #2d3748;
                    font-weight: 700;
                    margin-bottom: 0.5rem;
                    display: flex;
                    align-items: center;
                    gap: 0.5rem;
                }
                
                .form-subtitle {
                    color: #718096;
                    font-size: 0.95rem;
                    margin-bottom: 1.5rem;
                }
                
                .form-group {
                    margin-bottom: 1.2rem;
                }
                
                .form-label {
                    display: block;
                    font-weight: 600;
                    color: #2d3748;
                    margin-bottom: 0.4rem;
                    font-size: 0.95rem;
                }
                
                .form-control {
                    width: 100%;
                    padding: 0.6rem 1rem;
                    border: 1px solid #cbd5e0;
                    border-radius: 8px;
                    font-size: 0.95rem;
                    transition: border-color 0.3s, box-shadow 0.3s;
                    background: white;
                }
                
                .form-control:focus {
                    outline: none;
                    border-color: #667eea;
                    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.2);
                }
                
                .form-control:disabled {
                    background-color: #f8fafc;
                    color: #a0aec0;
                    cursor: not-allowed;
                }
                
                .text-danger {
                    color: #e53e3e;
                    font-size: 0.85rem;
                    margin-top: 0.3rem;
                    display: block;
                }
                
                .btn-primary-custom {
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    border: none;
                    color: white;
                    padding: 0.65rem 1.8rem;
                    border-radius: 10px;
                    font-weight: 600;
                    font-size: 1rem;
                    transition: all 0.3s ease;
                    cursor: pointer;
                }
                
                .btn-primary-custom:hover {
                    transform: translateY(-2px);
                    box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
                }
                
                .btn-secondary-custom {
                    background: #f1f5f9;
                    border: 1px solid #cbd5e0;
                    color: #4a5568;
                    padding: 0.65rem 1.8rem;
                    border-radius: 10px;
                    font-weight: 600;
                    font-size: 1rem;
                    transition: all 0.3s ease;
                    cursor: pointer;
                    text-decoration: none;
                    display: inline-block;
                    text-align: center;
                }
                
                .btn-secondary-custom:hover {
                    background: #e2e8f0;
                    transform: translateY(-1px);
                    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
                }
                
                .form-actions {
                    display: flex;
                    gap: 1rem;
                    margin-top: 1.5rem;
                    flex-wrap: wrap;
                }
                
                /* Responsive: una columna en móvil */
                @media (max-width: 768px) {
                    .form-card {
                        padding: 1.5rem;
                    }
                    
                    .form-title {
                        font-size: 1.3rem;
                    }
                    
                    .form-actions {
                        flex-direction: column;
                    }
                    
                    .btn-primary-custom,
                    .btn-secondary-custom {
                        width: 100%;
                        justify-content: center;
                    }
                }
                
                /* Ajuste para el grid en escritorio */
                .form-row {
                    display: grid;
                    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
                    gap: 1.5rem;
                    margin-bottom: 1.5rem;
                }
            </style>
        </ui:define>
        
        <ui:define name="content">
            <div class="form-card">
                <h2 class="form-title">
                    <i class="bi #{userController.user.idUsuario == null ? 'bi-person-plus' : 'bi-person-gear'}"></i>
                    <h:outputText value="#{userController.user.idUsuario == null ? 'Registrar Usuario' : 'Editar Usuario'}" />
                </h2>
                <p class="form-subtitle">
                    <h:outputText value="#{userController.user.idUsuario == null ? 
                        'Completa los datos para crear un nuevo usuario' : 
                        'Modifica la información del usuario'}" />
                </p>

                <h:form id="formUsuario">
                    <!-- Mensajes globales -->
                    <h:messages globalOnly="true" 
                                infoStyle="color: #28a745; font-weight: bold; margin-bottom: 1rem; display: block;" 
                                errorStyle="color: #dc3545; font-weight: bold; margin-bottom: 1rem; display: block;" 
                                layout="block"/>

                    <!-- Grid de campos -->
                    <div class="form-row">
                        <!-- Tipo Documento -->
                        <div class="form-group">
                            <label for="tipoDocumento" class="form-label">Tipo Documento *</label>
                            <h:selectOneMenu id="tipoDocumento" 
                                             value="#{userController.user.tipoDocumentoUsuario}" 
                                             required="true" 
                                             requiredMessage="Seleccione el tipo de documento"
                                             styleClass="form-control">
                                <f:selectItem itemLabel="Seleccione..." itemValue=""/>
                                <f:selectItem itemValue="CC" itemLabel="Cédula de Ciudadanía"/>
                                <f:selectItem itemValue="TI" itemLabel="Tarjeta de Identidad"/>
                                <f:selectItem itemValue="CE" itemLabel="Cédula de Extranjería"/>
                            </h:selectOneMenu>
                            <h:message for="tipoDocumento" styleClass="text-danger"/>
                        </div>

                        <!-- Número Documento -->
                        <div class="form-group">
                            <label for="numeroDocumento" class="form-label">Número Documento *</label>
                            <h:inputText id="numeroDocumento" 
                                         value="#{userController.user.numeroDocumento}" 
                                         required="true" 
                                         requiredMessage="Campo obligatorio"
                                         disabled="#{userController.user.idUsuario != null}"
                                         maxlength="15"
                                         styleClass="form-control"/>
                            <h:message for="numeroDocumento" styleClass="text-danger"/>
                        </div>

                        <!-- Nombres -->
                        <div class="form-group">
                            <label for="nombreUsuario" class="form-label">Nombres *</label>
                            <h:inputText id="nombreUsuario" 
                                         value="#{userController.user.nombreUsuario}" 
                                         required="true" 
                                         requiredMessage="Campo obligatorio"
                                         disabled="#{userController.user.nombreUsuario != null}"
                                         maxlength="45"
                                         styleClass="form-control"/>
                            <h:message for="nombreUsuario" styleClass="text-danger"/>
                        </div>

                        <!-- Apellidos -->
                        <div class="form-group">
                            <label for="apellidoUsuario" class="form-label">Apellidos *</label>
                            <h:inputText id="apellidoUsuario" 
                                         value="#{userController.user.apellidoUsuario}" 
                                         required="true" 
                                         requiredMessage="Campo obligatorio"
                                         disabled="#{userController.user.apellidoUsuario != null}"
                                         maxlength="45"
                                         styleClass="form-control"/>
                            <h:message for="apellidoUsuario" styleClass="text-danger"/>
                        </div>

                        <!-- Teléfono -->
                        <div class="form-group">
                            <label for="telUsuario" class="form-label">Teléfono *</label>
                            <h:inputText id="telUsuario" 
                                         value="#{userController.user.telUsuario}" 
                                         required="true" 
                                         requiredMessage="Campo obligatorio"
                                         maxlength="12"
                                         styleClass="form-control"/>
                            <h:message for="telUsuario" styleClass="text-danger"/>
                        </div>

                        <!-- Dirección -->
                        <div class="form-group">
                            <label for="direccionUsuario" class="form-label">Dirección *</label>
                            <h:inputText id="direccionUsuario" 
                                         value="#{userController.user.direcccionUsuario}" 
                                         required="true" 
                                         requiredMessage="Campo obligatorio"
                                         maxlength="120"
                                         styleClass="form-control"/>
                            <h:message for="direccionUsuario" styleClass="text-danger"/>
                        </div>

                        <!-- Correo -->
                        <div class="form-group">
                            <label for="correoUsuario" class="form-label">Correo Electrónico *</label>
                            <h:inputText id="correoUsuario" 
                                         value="#{userController.user.correoUsuario}" 
                                         required="true" 
                                         requiredMessage="Campo obligatorio"
                                         maxlength="120"
                                         styleClass="form-control"/>
                            <h:message for="correoUsuario" styleClass="text-danger"/>
                        </div>

                        <!-- Contraseña -->
                        <div class="form-group">
                            <label for="passwordUsuario" class="form-label">Contraseña *</label>
                            <h:inputSecret id="passwordUsuario" 
                                           value="#{userController.user.paswordUsuario}" 
                                           required="true" 
                                           requiredMessage="Campo obligatorio"
                                           disabled="#{userController.user.paswordUsuario != null}"
                                           maxlength="120"
                                           styleClass="form-control"/>
                            <h:message for="passwordUsuario" styleClass="text-danger"/>
                        </div>

                        <!-- Estado -->
                        <div class="form-group">
                            <label for="estadoUsuario" class="form-label">Estado *</label>
                            <h:selectOneMenu id="estadoUsuario" 
                                             value="#{userController.user.estadoUsuario}" 
                                             required="true" 
                                             requiredMessage="Seleccione el estado"
                                             styleClass="form-control">
                                <f:selectItems value="#{userController.listaEstados}" />
                            </h:selectOneMenu>
                            <h:message for="estadoUsuario" styleClass="text-danger"/>
                        </div>

                        <!-- Rol -->
                        <div class="form-group">
                            <label for="rolUsuario" class="form-label">Rol *</label>
                            <h:selectOneMenu id="rolUsuario" 
                                             value="#{userController.rolSeleccionado}" 
                                             required="true" 
                                             requiredMessage="Seleccione el rol"
                                             styleClass="form-control">
                                <f:selectItems value="#{userController.listaRoles}" />
                            </h:selectOneMenu>
                            <h:message for="rolUsuario" styleClass="text-danger"/>
                        </div>
                    </div>

                    <!-- Botones de acción -->
                    <div class="form-actions">
                        <h:commandButton 
                            value="#{userController.user.idUsuario == null ? 'Registrar Usuario' : 'Actualizar Usuario'}" 
                            action="#{userController.guardarUsuario}" 
                            styleClass="btn-primary-custom"/>
                        
                        <h:button 
                            value="Cancelar" 
                            outcome="/views/usuario/indexUsuario.xhtml" 
                            styleClass="btn-secondary-custom"/>
                    </div>
                </h:form>
            </div>
        </ui:define>
    </ui:composition>
</body>
</html>
