<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                template="/views/newTemplate.xhtml">
<ui:define name="title">Mis Pedidos</ui:define>
    <ui:define name="content">

        <div class="container my-4">

            <!-- Encabezado -->
            <div class="d-flex flex-column flex-md-row justify-content-between align-items-start mb-4">
                <div>
                    <h2 class="mb-1">Mis Pedidos</h2>
                    <p class="text-muted mb-0">Gestiona y realiza seguimiento a tus pedidos</p>
                </div>
            </div>

            <h:form id="ordersForm">

                <!-- Lista de pedidos -->
                <div class="row g-4">
                    <ui:repeat value="#{clienteController.misPedidos}" var="pedido">
                        <div class="col-12 col-md-6 col-lg-4">
                            <div class="card shadow-sm h-100 border-0">

                                <!-- Cabecera de la tarjeta -->
                                <div class="card-header d-flex justify-content-between align-items-center bg-light border-bottom">
                                    <span class="fw-bold">Pedido ##{pedido.idPedido}</span>
                                    <span class="badge #{pedido.estado eq 'pendiente' ? 'bg-warning text-dark' : 'bg-success'}">
                                        #{pedido.estado}
                                    </span>
                                </div>

                                <!-- Cuerpo de la tarjeta -->
                                <div class="card-body">
                                    <p class="mb-2"><strong>Fecha:</strong>
                                        <h:outputText value="#{pedido.fechaPedido}">
                                            <f:convertDateTime pattern="dd/MM/yyyy HH:mm:ss"/>
                                        </h:outputText>
                                    </p>
                                    <p class="mb-2"><strong>Total:</strong> $#{pedido.total}</p>
                                    <p class="mb-0"><strong>Dirección:</strong> 
                                        #{pedido.direccionEntrega != null ? pedido.direccionEntrega : 'No registrada'}
                                    </p>
                                </div>

                                <!-- Pie de la tarjeta -->
                                <div class="card-footer text-end bg-light border-top">
                                    <h:commandButton value="Ver Detalle"
                                                     action="#{clienteController.verDetallePedido(pedido)}"
                                                     styleClass="btn btn-primary btn-sm"/>
                                </div>

                            </div>
                        </div>
                    </ui:repeat>
                </div>

                <!-- Mensaje si no hay pedidos -->
                <h:panelGroup rendered="#{empty clienteController.misPedidos}" class="mt-4">
                    <div class="alert alert-info" role="alert">
                        No has realizado ningún pedido aún.
                    </div>
                </h:panelGroup>

            </h:form>

        </div>

    </ui:define>
</ui:composition>
