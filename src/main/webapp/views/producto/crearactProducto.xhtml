<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

<body>
    <ui:composition template="./../newTemplate.xhtml">
        
        <ui:define name="title">
            <h:outputText value="#{empty productController.pro.idProducto ? 'Registrar Producto' : 'Editar Producto'}" />
        </ui:define>
        
        <ui:define name="head">
            <style>
                .form-card {
                    background: rgba(255, 255, 255, 0.98);
                    border-radius: 12px;
                    padding: 2rem;
                    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
                    border: 1px solid rgba(255, 255, 255, 0.6);
                    margin-bottom: 2rem;
                }
                
                .form-title {
                    color: #2d3748;
                    font-weight: 700;
                    margin-bottom: 0.5rem;
                    display: flex;
                    align-items: center;
                    gap: 0.5rem;
                    justify-content: center;
                }
                
                .form-subtitle {
                    color: #718096;
                    font-size: 0.95rem;
                    margin-bottom: 1.5rem;
                    text-align: center;
                }
                
                .form-group {
                    margin-bottom: 1.2rem;
                }
                
                .form-label {
                    display: block;
                    font-weight: 600;
                    color: #2d3748;
                    margin-bottom: 0.4rem;
                    font-size: 0.95rem;
                }
                
                .form-control,
                .form-select {
                    width: 100%;
                    padding: 0.6rem 1rem;
                    border: 1px solid #cbd5e0;
                    border-radius: 8px;
                    font-size: 0.95rem;
                    transition: border-color 0.3s, box-shadow 0.3s;
                    background: white;
                }
                
                .form-control:focus,
                .form-select:focus {
                    outline: none;
                    border-color: #667eea;
                    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.2);
                }
                
                .text-danger {
                    color: #e53e3e;
                    font-size: 0.85rem;
                    margin-top: 0.3rem;
                    display: block;
                }
                
                .text-muted {
                    color: #718096;
                    font-size: 0.85rem;
                    margin-top: 0.3rem;
                    display: block;
                }
                
                .btn-primary-custom {
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    border: none;
                    color: white;
                    padding: 0.65rem 1.8rem;
                    border-radius: 10px;
                    font-weight: 600;
                    font-size: 1rem;
                    transition: all 0.3s ease;
                    cursor: pointer;
                }
                
                .btn-primary-custom:hover {
                    transform: translateY(-2px);
                    box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
                }
                
                .btn-secondary-custom {
                    background: #f1f5f9;
                    border: 1px solid #cbd5e0;
                    color: #4a5568;
                    padding: 0.65rem 1.8rem;
                    border-radius: 10px;
                    font-weight: 600;
                    font-size: 1rem;
                    transition: all 0.3s ease;
                    cursor: pointer;
                    text-decoration: none;
                    display: inline-block;
                    text-align: center;
                }
                
                .btn-secondary-custom:hover {
                    background: #e2e8f0;
                    transform: translateY(-1px);
                    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
                }
                
                .form-actions {
                    display: flex;
                    gap: 1rem;
                    margin-top: 1.5rem;
                    justify-content: center;
                    flex-wrap: wrap;
                }
                
                /* Responsive: una columna en móvil */
                @media (max-width: 768px) {
                    .form-card {
                        padding: 1.5rem;
                    }
                    
                    .form-title {
                        font-size: 1.3rem;
                    }
                    
                    .form-actions {
                        flex-direction: column;
                    }
                    
                    .btn-primary-custom,
                    .btn-secondary-custom {
                        width: 100%;
                    }
                }
                
                /* Grid responsive para escritorio */
                .form-row {
                    display: grid;
                    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
                    gap: 1.5rem;
                    margin-bottom: 1.5rem;
                }
            </style>
        </ui:define>
        
        <ui:define name="content">
            <div class="form-card">
                <h2 class="form-title">
                    <i class="bi #{empty productController.pro.idProducto ? 'bi-box-seam' : 'bi-pencil-square'}"></i>
                    <h:outputText value="#{empty productController.pro.idProducto ? 'Registrar Producto' : 'Editar Producto'}" />
                </h2>
                <p class="form-subtitle">
                    <h:outputText value="#{empty productController.pro.idProducto ? 
                        'Completa los datos para agregar un nuevo producto al catálogo' : 
                        'Modifica la información del producto'}" />
                </p>

                <h:form id="formProducto">
                    <!-- Mensajes globales -->
                    <h:messages globalOnly="true" 
                                infoStyle="color: #28a745; font-weight: bold; margin-bottom: 1rem; display: block;" 
                                errorStyle="color: #dc3545; font-weight: bold; margin-bottom: 1rem; display: block;" 
                                layout="block"/>

                    <!-- Grid de campos -->
                    <div class="form-row">
                        <!-- Código Producto -->
                        <div class="form-group">
                            <label for="codigoProducto" class="form-label">Código Producto *</label>
                            <h:inputText id="codigoProducto" 
                                         value="#{productController.pro.codigoProducto}" 
                                         required="true" 
                                         requiredMessage="El código es obligatorio"
                                         maxlength="20"
                                         styleClass="form-control"/>
                            <h:message for="codigoProducto" styleClass="text-danger"/>
                        </div>

                        <!-- Nombre Producto -->
                        <div class="form-group">
                            <label for="nombreProducto" class="form-label">Nombre Producto *</label>
                            <h:inputText id="nombreProducto" 
                                         value="#{productController.pro.nombreProducto}" 
                                         required="true" 
                                         requiredMessage="El nombre es obligatorio"
                                         maxlength="100"
                                         styleClass="form-control"/>
                            <h:message for="nombreProducto" styleClass="text-danger"/>
                        </div>

                        <!-- Stock -->
                        <div class="form-group">
                            <label for="stockProduccto" class="form-label">Stock *</label>
                            <h:inputText id="stockProduccto" 
                                         value="#{productController.pro.stockProduccto}" 
                                         required="true"
                                         requiredMessage="El stock es obligatorio"
                                         styleClass="form-control">
                                <f:convertNumber integerOnly="true" type="number"/>
                            </h:inputText>
                            <h:message for="stockProduccto" styleClass="text-danger"/>
                        </div>

                        <!-- Precio -->
                        <div class="form-group">
                            <label for="valorProducto" class="form-label">Precio *</label>
                            <h:inputText id="valorProducto" 
                                         value="#{productController.pro.valorProducto}" 
                                         required="true"
                                         requiredMessage="El precio es obligatorio"
                                         maxlength="10"
                                         styleClass="form-control"/>
                            <small class="text-muted">Ejemplo: 15000</small>
                            <h:message for="valorProducto" styleClass="text-danger"/>
                        </div>

                        <!-- Categoría - ✅ CORREGIDO: usa categoriaTemporal -->
                        <div class="form-group">
                            <label for="categoriaTemporal" class="form-label">Categoría *</label>
                            <h:selectOneMenu id="categoriaTemporal" 
                                             value="#{productController.categoriaTemporal}" 
                                             required="true" 
                                             requiredMessage="Seleccione la categoría"
                                             styleClass="form-select">
                                <f:selectItem itemValue="" itemLabel="Seleccione categoría"/>
                                <f:selectItems value="#{productController.listaCategorias}" />
                            </h:selectOneMenu>
                            <h:message for="categoriaTemporal" styleClass="text-danger"/>
                        </div>

                        <!-- Estado -->
                        <div class="form-group">
                            <label for="estadoProducto" class="form-label">Estado *</label>
                            <h:selectOneMenu id="estadoProducto" 
                                             value="#{productController.pro.estadoProducto}" 
                                             required="true" 
                                             requiredMessage="Seleccione el estado"
                                             styleClass="form-select">
                                <f:selectItem itemValue="" itemLabel="Seleccione estado"/>
                                <f:selectItems value="#{productController.listaEstados}" />
                            </h:selectOneMenu>
                            <h:message for="estadoProducto" styleClass="text-danger"/>
                        </div>
                    </div>

                    <!-- Botones de acción -->
                    <div class="form-actions">
                        <h:commandButton 
                            value="#{empty productController.pro.idProducto ? 'Registrar Producto' : 'Actualizar Producto'}" 
                            action="#{productController.guardarProducto}" 
                            styleClass="btn-primary-custom"/>
                        
                        <h:button 
                            value="Cancelar" 
                            outcome="indexProducto" 
                            styleClass="btn-secondary-custom"/>
                    </div>
                </h:form>
            </div>
        </ui:define>
    </ui:composition>
</body>
</html>
