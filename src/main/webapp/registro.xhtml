<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

    <h:head>
        <title>Registro de Usuario - Desayunos y Detalles</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />

        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" />

        <link rel="icon" href="#{resource['images/logo.png']}" type="image/x-icon" /> 
        <h:outputStylesheet name="/css/Inicio.css"/> 

    </h:head>

    <h:body styleClass="bg-auth">
        <div class="register-container">
            <div class="register-card">
                <div class="row g-0">
                    <div class="col-lg-5 register-image ps-5">
                        <div class="register-image-content">
                            <h2>Únete a nuestra comunidad</h2>
                            <p>Crea una cuenta para acceder a los mejores desayunos y detalles para ocasiones especiales.</p>
                            <div style="font-size: 5rem; margin-top: 30px;">
                                <i class="bi bi-person-plus"></i>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-7">
                        <div class="register-form">
                            <h2 class="register-title">Registro de Cliente</h2>
                            <h:form id="formRegistro">

                                <div class="form-section">
                                    <div class="form-section-title">Información Personal</div>
                                    <div class="form-grid">
                                        <div class="mb-3">
                                            <h:outputLabel value="Tipo Documento:" styleClass="form-label" for="tipoDocumento" />
                                            <div class="input-icon">
                                                <i class="bi bi-card-checklist"></i>
                                                <h:selectOneMenu id="tipoDocumento" value="#{userController.user.tipoDocumentoUsuario}" 
                                                                 required="true" styleClass="form-select"
                                                                 requiredMessage="Seleccione el tipo de documento">
                                                    <f:selectItem itemLabel="Seleccione..." itemValue=""/>
                                                    <f:selectItem itemValue="CC" itemLabel="Cédula de Ciudadanía"/>
                                                    <f:selectItem itemValue="TI" itemLabel="Tarjeta de Identidad"/>
                                                    <f:selectItem itemValue="CE" itemLabel="Cédula de Extranjería"/>
                                                </h:selectOneMenu>
                                            </div>
                                            <h:message for="tipoDocumento" styleClass="text-danger" />
                                        </div>

                                        <div class="mb-3">
                                            <h:outputLabel value="Número Documento:" styleClass="form-label" for="numeroDocumento" />
                                            <div class="input-icon">
                                                <i class="bi bi-123"></i>
                                                <h:inputText id="numeroDocumento" value="#{userController.user.numeroDocumento}" 
                                                             required="true" styleClass="form-control"
                                                             requiredMessage="Campo obligatorio" 
                                                             validatorMessage="Número de documento inválido (solo dígitos, 5-15 caracteres)"
                                                             maxlength="15">
                                                    <!-- regex: solo dígitos, entre 5 y 15 -->
                                                    <f:validateRegex pattern="^[0-9]{5,15}$" />
                                                </h:inputText>
                                            </div>
                                            <h:message for="numeroDocumento" styleClass="text-danger" />
                                        </div>
                                    </div>
                                </div>

                                <div class="form-section">
                                    <div class="form-section-title">Datos Personales</div>
                                    <div class="form-grid">
                                        <div class="mb-3">
                                            <h:outputLabel value="Nombres:" styleClass="form-label" for="nombreUsuario" />
                                            <div class="input-icon">
                                                <i class="bi bi-person"></i>
                                                <h:inputText id="nombreUsuario" 
                                                             value="#{userController.user.nombreUsuario}" 
                                                             required="true" 
                                                             styleClass="form-control"
                                                             requiredMessage="Campo obligatorio"
                                                             validatorMessage="Solo se permiten letras minúsculas (a–z)"
                                                             maxlength="45">
                                                    <f:validateRegex pattern="^[a-záéíóúñ ]+$" />
                                                </h:inputText>


                                            </div>
                                            <h:message for="nombreUsuario" styleClass="text-danger" />
                                        </div>

                                        <div class="mb-3">
                                            <h:outputLabel value="Apellidos:" styleClass="form-label" for="apellidoUsuario" />
                                            <div class="input-icon">
                                                <i class="bi bi-person"></i>
                                                <h:inputText id="apellidoUsuario" 
                                                             value="#{userController.user.apellidoUsuario}" 
                                                             required="true" 
                                                             styleClass="form-control"
                                                             requiredMessage="Campo obligatorio"
                                                             validatorMessage="Solo se permiten letras minúsculas (a–z)"
                                                             maxlength="45">
                                                    <f:validateRegex pattern="^[a-záéíóúñ ]+$" />
                                                </h:inputText>

                                            </div>
                                            <h:message for="apellidoUsuario" styleClass="text-danger" />
                                        </div>
                                    </div>
                                </div>

                                <div class="form-section">
                                    <div class="form-section-title">Información de Contacto</div>
                                    <div class="form-grid">
                                        <div class="mb-3">
                                            <h:outputLabel value="Teléfono:" styleClass="form-label" for="telUsuario" />
                                            <div class="input-icon">
                                                <i class="bi bi-telephone"></i>
                                                <h:inputText id="telUsuario" value="#{userController.user.telUsuario}" 
                                                             required="true" styleClass="form-control"
                                                             requiredMessage="Campo obligatorio" 
                                                             validatorMessage="Teléfono inválido (solo dígitos, 7-12 caracteres)"
                                                             maxlength="12">
                                                    <!-- regex: solo dígitos, entre 7 y 12 -->
                                                    <f:validateRegex pattern="^[0-9]{7,12}$" />
                                                </h:inputText>
                                            </div>
                                            <h:message for="telUsuario" styleClass="text-danger" />
                                        </div>

                                        <div class="mb-3">
                                            <h:outputLabel value="Correo:" styleClass="form-label" for="correoUsuario" />
                                            <div class="input-icon">
                                                <i class="bi bi-envelope"></i>
                                                <h:inputText id="correoUsuario" value="#{userController.user.correoUsuario}" 
                                                             required="true" styleClass="form-control"
                                                             requiredMessage="Campo obligatorio" 
                                                             validatorMessage="Ingrese un correo válido (ej: usuario@dominio.com)"
                                                             maxlength="120">
                                                    <!-- regex de correo robusta: usuario@dominio.tld (acepta dominios como .com, .net, .co, etc.) -->
                                                    <f:validateRegex pattern="^[A-Za-z0-9._%+\-]+@[A-Za-z0-9.\-]+\.[A-Za-z]{2,}$" />
                                                </h:inputText>
                                            </div>
                                            <h:message for="correoUsuario" styleClass="text-danger" />
                                        </div>
                                    </div>

                                    <div class="mb-3">
                                        <h:outputLabel value="Dirección:" styleClass="form-label" for="direccionUsuario" />
                                        <div class="input-icon">
                                            <i class="bi bi-geo-alt"></i>
                                            <h:inputText id="direccionUsuario" value="#{userController.user.direcccionUsuario}" 
                                                         required="true" styleClass="form-control"
                                                         requiredMessage="Campo obligatorio" 
                                                         maxlength="120" />
                                        </div>
                                        <h:message for="direccionUsuario" styleClass="text-danger" />
                                    </div>
                                </div>

                                <div class="form-section">
                                    <div class="form-section-title">Seguridad</div>
                                    <div class="mb-3">
                                        <h:outputLabel value="Contraseña:" styleClass="form-label" for="passwordUsuario" />
                                        <div class="input-icon">
                                            <i class="bi bi-lock"></i>
                                            <h:inputSecret id="passwordUsuario" value="#{userController.user.paswordUsuario}" 
                                                           required="true" styleClass="form-control"
                                                           requiredMessage="Campo obligatorio"
                                                           validatorMessage="La contraseña debe tener mínimo 8 caracteres, incluir mayúscula, minúscula, número y caracter especial"
                                                           maxlength="120">
                                                <!-- 
                                                    regex contraseña:
                                                    - al menos 1 minúscula
                                                    - al menos 1 mayúscula
                                                    - al menos 1 dígito
                                                    - al menos 1 caracter especial (se escapa & como &amp;)
                                                    - mínimo 8 caracteres
                                                -->
                                                <f:validateRegex pattern="^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[@$!%*?&amp;._\-])[A-Za-z0-9@$!%*?&amp;._\-]{8,}$" />
                                            </h:inputSecret>
                                        </div>
                                        <h:message for="passwordUsuario" styleClass="text-danger" />
                                    </div>
                                </div>

                                <h:messages id="mensajesGlobales" globalOnly="true" 
                                            infoClass="alert alert-success" 
                                            errorClass="alert alert-danger" 
                                            layout="table"/>

                                <div class="button-container">
                                    <h:commandButton value="Registrarse" 
                                                     action="#{userController.registrarCliente}" 
                                                     styleClass="btn-register"/>

                                    <h:button value="Cancelar" outcome="/inicio.xhtml" 
                                              styleClass="btn-cancel"/>
                                </div>

                                <div class="text-center mt-4">
                                    <p class="text-muted">¿Ya tienes una cuenta? 
                                        <h:button value="Inicia sesión aquí" outcome="/login.xhtml" style="color: #667eea; text-decoration: none; font-weight: 500;" />
                                    </p>
                                </div>
                            </h:form>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    </h:body>
</html>
